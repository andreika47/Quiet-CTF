# Das Ist Thompson
**MCTF 2025**

Название и код задания намекают на криптосистему, основанную на группе Томпсона. Погуглив, можно наткнуться на статью, которая описываете теоритическую возможность реализации ассиметричной криптосистемы: https://www.researchgate.net/publication/227334937_Thompson's_Group_and_Public_Key_Cryptography
TLDR: 
Статья рассматривает возможность использования одной из групп Томпсона в криптографии. В частности рассматривается $F$ группа Томпсона, которая является неабелевой группой (элементы таких групп не всегда коммутируют, то есть существуют такие элементы $a, b$, для которых $a * b != b * a$). Однако, из элементов $F$ группы Томпсона можно сформировать два непересекающихся множества $A$ и $B$, которые будут коммутировать между собой (то есть для любого элемента из $A$ и любого элемента из $B$ верно $a * b = b * a$). Статья предлагает алгоритм генерации таких множеств и предлагает способ их использования в криптосистеме.
Элементы $F$ группы Томпсона предлагается представить как композицию генераторов - условно базовых элементов, из которых можно собрать любой элемент группы, например, $a = x_0 * x_1 * x_4 * x_4$, где $x_0, x_1, x_4$ - некоторые генераторы группы.
Для генерации общего ключа предлагается следующий алгоритм:
1. Случайно выбираются публичные параметры $s$ и $M$: размер множеств генераторов для различных ключей и размеры ключей.
2. Из множества генераторов собирается общий публичный ключ $w$
3. Алиса генерирует собственные закрытые ключи $a_1$ из множества $A$ и $b_1$ из множества $B$
4. Алиса вычисляет $A = a_1 * w * b_1$ и отправляет его Бобу
5. Боб генерирует собственные закрытые ключи $a_2$ из множества $A$ и $b_2$ из множества $B$
6. Боб вычисляет $B = b_2 * w * a_2$ и отправляет его Алисе
7. Алиса и Боб вычисляют общий закрытый ключ $K = a_1 * B * b_1 = b_2 * A * a_2$

За счет того, что элементы множеств $A$ и $B$ коммутируют между собой 
$K = a1 * B * b1 = a1 * b2 * w * a2 * b1 = b2 * a1 * w * b1 * a2 = b2 * A * a2$
А безопасность данной криптосистеме основана на сложности решения задачи декомпозиции в группе Томпсона, то есть для заданного c найти элементы $d, e$, такие что $c = d * e$

Погуглив еще можно найти статью, которая показывает что для данной криптосистемы задача декомпозиции не слишком и сложна: https://boa.unimib.it/retrieve/handle/10281/214402/309753/thompson-crypto-break5.pdf 
TLDR:
Оказывается, что предложенный вариант генерации множеств $A$, $B$ создает особенные элементы, которые можно легко вычленить из композиции элементов. В статье рассматривается два варианта:
1. Элементы множества $A$ при композиции с $w$ действуют как единица группы (то есть $a * w = w$), а генераторы элементов множества $B$ не пересекаются с генераторами $w$, поэтому их легко разделить друг от друга
2. Элементы множества $B$ при композиции с $w$ действуют как единица группы (то есть $b * w = w$), а генераторы элементов множества $A$ не пересекаются с генераторами $w$, поэтому их легко разделить друг от друга

Предлагается реализовать и проверить атаку из статьи на обоих вариантах - один из них должен сработать и мы получим флаг.
Пример кода решения: [solve.py](https://github.com/andreika47/Quiet-CTF/blob/main/Das%20Ist%20Thompson/solve.py)

#crypto #non-commutative #thompson